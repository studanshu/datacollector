
<!DOCTYPE html
  SYSTEM "about:legacy-compat">
<html xml:lang="en-us" lang="en-us">
<head><meta name="description" content="The Hive Metastore destination works with the Hive Metadata processor and Hadoop FS destination as part of the Hive Drift Solution. The Hive Metastore destination uses metadata records generated by ..."></meta><meta http-equiv="Content-Type" content="text/html; charset=utf-8"></meta><meta name="copyright" content="(C) Copyright 2005"></meta><meta name="DC.rights.owner" content="(C) Copyright 2005"></meta><meta name="DC.Type" content="concept"></meta><meta name="DC.Title" content="Hive Metastore"></meta><meta name="abstract" content="The Hive Metastore destination works with the Hive Metadata processor and Hadoop FS destination as part of the Hive Drift Solution. The Hive Metastore destination uses metadata records generated by the Hive Metadata processor to create and update Hive tables. This enables the Hadoop FS destination to write drifting data to HDFS."></meta><meta name="description" content="The Hive Metastore destination works with the Hive Metadata processor and Hadoop FS destination as part of the Hive Drift Solution. The Hive Metastore destination uses metadata records generated by the Hive Metadata processor to create and update Hive tables. This enables the Hadoop FS destination to write drifting data to HDFS."></meta><meta name="DC.Relation" scheme="URI" content="../Destinations/Destinations-title.html"></meta><meta name="DC.Relation" scheme="URI" content="../Hive_Metadata/HiveDrift-Overview.html#concept_phk_bdf_2w"></meta><meta name="DC.Relation" scheme="URI" content="../Hive_Metadata/HiveDataTypes.html#concept_ry2_qkm_hw"></meta><meta name="DC.Format" content="XHTML"></meta><meta name="DC.Identifier" content="concept_gcr_z2t_zv"></meta><link rel="stylesheet" type="text/css" href="../oxygen-webhelp/resources/css/commonltr.css"><!----></link><title>Hive Metastore</title><!--  Generated with Oxygen version 17.1, build number 2016020417.  --><meta http-equiv="Content-Type" content="text/html; charset=utf-8"></meta><link rel="stylesheet" type="text/css" href="../oxygen-webhelp/resources/css/webhelp_topic.css"><!----></link><link rel="stylesheet" type="text/css" href="../oxygen-webhelp/resources/skins/skin.css"><!----></link><link rel="stylesheet" type="text/css" href="../skin.css"></link><script type="text/javascript"><!--
          
          var prefix = "../index.html";
          
          --></script><script type="text/javascript" src="../oxygen-webhelp/resources/js/jquery-1.8.2.min.js"><!----></script><script type="text/javascript" src="../oxygen-webhelp/resources/js/jquery.cookie.js"><!----></script><script type="text/javascript" src="../oxygen-webhelp/resources/js/jquery-ui.custom.min.js"><!----></script><script type="text/javascript" src="../oxygen-webhelp/resources/js/jquery.highlight-3.js"><!----></script><script type="text/javascript" charset="utf-8" src="../oxygen-webhelp/resources/js/webhelp_topic.js"><!----></script><!--
  Licensed under the Apache License, Version 2.0 (the "License");
  you may not use this file except in compliance with the License.
  You may obtain a copy of the License at

      http://www.apache.org/licenses/LICENSE-2.0

  Unless required by applicable law or agreed to in writing, software
  distributed under the License is distributed on an "AS IS" BASIS,
  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  See the License for the specific language governing permissions and
  limitations under the License.
--></head>
<body onload="highlightSearchTerm()" class="frmBody"><script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
​
  ga('create', 'UA-53969024-1', 'auto');
  ga('send', 'pageview');
​
</script>
<table class="nav"><tbody><tr><td colspan="2"><div id="printlink"><a href="javascript:window.print();" title="Print this page"></a></div><div id="permalink"><a href="#" title="Link to this page"></a></div></td></tr><tr><td width="75%"><a class="navheader_parent_path" href="../Destinations/Destinations-title.html" title="Destinations">Destinations</a></td><td><div class="navheader">
<span class="navparent"><a class="link" href="../Destinations/Destinations-title.html" title="Destinations"><span class="navheader_label">Parent topic</span><span class="navheader_separator">: </span><span class="navheader_linktext">Destinations</span></a></span>  </div></td></tr></tbody></table>
<div class="nested0" id="concept_gcr_z2t_zv">
 <h1 class="title topictitle1">Hive Metastore</h1>

 
 <div class="body conbody"><p class="shortdesc">The Hive Metastore destination works with the Hive Metadata processor and Hadoop FS
        destination as part of the Hive Drift Solution. The Hive Metastore destination uses metadata
        records generated by the Hive Metadata processor to create and update Hive tables. This
        enables the Hadoop FS destination to write drifting data to HDFS. </p>

        <p class="p">The Hive Metastore
            destination compares information in metadata records with Hive tables, and then creates
            or updates the tables as needed. For example, when the Hive Metadata processor
            encounters a record that requires a new Hive table, it passes a metadata record to the
            Hive Metastore destination and the destination creates the table.</p>

        <p class="p">Note that the Hive Metastore destination does not process data. It processes only
            metadata records generated by the Hive Metadata processor and must be downstream from
            the processor's metadata output stream.</p>

        <p class="p">When you configure Hive Metastore, you define the connection information for Hive, the
            location of the Hive and Hadoop configuration files and optionally specify additional
            required properties. You can also set a maximum cache size for the destination and
            determine how new tables are created and stored.</p>

        <div class="note note"><span class="notetitle">Note:</span> When using the destination in multiple pipelines, take care to avoid concurrent or
            conflicting writes to the same tables. </div>

    </div>

    <div class="related-links"><div class="relinfo relconcepts"><strong>Related concepts</strong><br xmlns="http://www.w3.org/1999/xhtml" />
<div class="related_link"><a class="navheader_parent_path" href="../Hive_Metadata/HiveDrift-Overview.html#concept_phk_bdf_2w" title="Hive Drift Solution: Ingesting Drifting Data into Hive">Hive Drift Solution: Ingesting Drifting Data into Hive</a></div>
<div class="related_link"><a class="navheader_parent_path" href="../Hive_Metadata/HiveDataTypes.html#concept_ry2_qkm_hw" title="Hive Data Types">Hive Data Types</a></div>
</div>
</div>
<div class="topic concept nested1" id="concept_f23_cqy_dw">
 <h2 class="title topictitle2">Metadata Processing</h2>

 <div class="body conbody">
        <p class="p">When processing records, Hive
            Metastore destination performs the following tasks:</p>

  <div class="p">
            <dl class="dl">
                
                    <dt class="dt dlterm">Creates or updates Hive tables as needed</dt>

                    <dd class="dd">
                        <ol class="ol" id="concept_f23_cqy_dw__ol_f2n_4kz_dw">
                            <li class="li">For each metadata record that includes a request to create or update
                                a table, the destination checks Hive for the table. </li>

                            <li class="li">If the table in the metadata record does not exist or differs from
                                the Hive table, the destination creates or updates the table as
                                needed. </li>

                        </ol>

                    </dd>

                
                
                    <dt class="dt dlterm">Creates new Avro schemas as needed</dt>

                    <dd class="dd">
                        <ol class="ol" id="concept_f23_cqy_dw__ol_yj2_qkz_dw">
                            <li class="li">For each metadata record that includes a schema change, the
                                destination checks Hive for the current set of columns for the
                                specified table.</li>

                            <li class="li">When there are compatible differences, the destination generates a
                                new Avro schema that incorporates the differences. <p class="p">This can occur
                                    when a separate entity changes the target table in the moments
                                    between evaluation by the Hive Metadata processor and the Hive
                                    Metastore destination.</p>
</li>

                        </ol>

                    </dd>

                
            </dl>

        </div>

        <div class="p">
            <div class="note note"><span class="notetitle">Note:</span> <span class="ph" id="concept_f23_cqy_dw__d1848e711">The destination can
                        create tables and partitions. It can add columns to tables and ignore
                        existing columns. It does not drop existing columns from tables.</span></div>

        </div>

 </div>

</div>
<div class="topic concept nested1" id="concept_wyr_5jv_hw">
 <h2 class="title topictitle2">Hive Table Generation</h2>

 <div class="body conbody">
  <div class="p">The Hive Metastore destination can generate Hive
            tables using the following methods:<dl class="dl">
                
                    <dt class="dt dlterm">With the Stored As Avro clause</dt>

                    <dd class="dd">Generates the table with a query that includes the Stored As Avro clause.
                        When using the Stored As Avro clause, the destination does not need to
                        generate an Avro schema for each change in the Hive table. </dd>

                    <dd class="dd">This is the default and recommended method for table generation. Enable the
                            <span class="ph uicontrol">Stored As Avro</span> property to use this method.</dd>

                
                
                    <dt class="dt dlterm">Without the Stored As Avro clause</dt>

                    <dd class="dd">Generates the table without a Stored As Avro clause in the query. Instead,
                        the destination generates an Avro schema for each Hive table update. The
                        destination uses the following format for the schema name:
                            <samp class="ph codeph">avro_schema_&lt;database&gt;_&lt;table&gt;_&lt;current
                            time&gt;.avsc</samp>.</dd>

                    <dd class="dd">The destination stores the Avro schema in HDFS. You can configure where the
                        destination saves the schemas. You can specify a full path or a path
                        relative to the table directory. By default, the destination saves the
                        schema in a <span class="ph filepath">.schemas</span> sub-folder of the table directory. </dd>

                    <dd class="dd">You can configure the destination to generate and store the schemas as a
                        specified HDFS user. <span class="ph">Data
                  Collector</span> must be configured as a proxy user in HDFS.</dd>

                
            </dl>
</div>

 </div>

</div>
<div class="topic concept nested1" id="concept_f4y_spy_dw">
 <h2 class="title topictitle2">Cache</h2>

 
 <div class="body conbody"><p class="shortdesc">The Hive Metastore destination queries Hive for information and caches the results. When
        possible, it uses the cache to avoid unnecessary Hive queries.</p>

  <div class="p">The destination caches the
            following Hive metadata:<ul class="ul" id="concept_f4y_spy_dw__ul_y1l_2dt_dw">
                <li class="li">Database and table to be written to</li>

                <li class="li">Hive table properties</li>

                <li class="li">Column names and types in the table</li>

                <li class="li">Partition values</li>

            </ul>
</div>

 </div>

<div class="topic concept nested2" id="concept_ovn_kdt_dw">
 <h3 class="title topictitle3">Cache Size and Evictions</h3>

 <p class="shortdesc">You can configure the maximum size of the cache. When the cache reaches the specified
        limit, it uses the LRU eviction policy, which removes the least recently used data to allow
        for new entries to be written to the cache. </p>

</div>
</div>
<div class="topic concept nested1" id="concept_wsq_dgd_3w">
 <h2 class="title topictitle2">Kerberos Authentication</h2>

 <div class="body conbody">
  <p class="p">When you use Kerberos authentication, <span class="ph">Data
                  Collector</span>
            uses the Kerberos principal and keytab to connect to HiveServer2. </p>

        <p class="p">The Kerberos principal and keytab are defined in the <span class="ph">Data
                  Collector</span>
            configuration file,<samp class="ph codeph"> $SDC_CONF/sdc.properties</samp>. To use Kerberos
            authentication, configure all Kerberos properties in the <span class="ph">Data
                  Collector</span>
            configuration file and include the Kerberos principal in the HiveServer2 JDBC URL.</p>

 </div>

    <div class="related-links"><div class="relinfo relconcepts"><strong>Related concepts</strong><br xmlns="http://www.w3.org/1999/xhtml" />
<div class="related_link"><a class="navheader_parent_path" href="../Install_Config/DCConfig.html#concept_hnm_n4l_xs" title="You can use Kerberos authentication to connect to external systems as well as YARN clusters.">Enabling Kerberos Authentication</a></div>
</div>
</div>
</div>
<div class="topic concept nested1" id="concept_smb_rdz_dw">
 <h2 class="title topictitle2">Hive Properties and Configuration Files</h2>

 
 <div class="body conbody"><p class="shortdesc">You must configure Hive Metastore to use Hive and Hadoop configuration files and
        individual properties.</p>

  <div class="p">
            <dl class="dl">
                
                    <dt class="dt dlterm">Configuration Files</dt>

                    <dd class="dd">
                        <div class="p">The following configuration files are required for the Hive Metastore
                                destination:<ul class="ul" id="concept_smb_rdz_dw__ul_gwv_kbs_dw">
                  <li class="li">core-site.xml</li>

                  <li class="li">hdfs-site.xml</li>

                  <li class="li">hive-site.xml</li>

            </ul>
</div>

                    </dd>

                
                
                    <dt class="dt dlterm">Individual properties</dt>

                    <dd class="dd">You can configure individual Hive properties in the destination. To add a
                        Hive property, specify the exact property name and the value. The processor
                        does not validate the property names or values.<div class="note note"><span class="notetitle">Note:</span> Individual properties
                            override properties defined in the configuration files.
                            </div>
</dd>

                
            </dl>

        </div>

 </div>

</div>
<div class="topic task nested1" id="task_a4n_1ft_zv">
    <h2 class="title topictitle2">Configuring a Hive Metastore Destination</h2>

    <div class="body taskbody">
        <div class="section context">
            <p class="p">Configure a Hive Metastore
                destination to process metadata records from the Hive Metadata processor and update
                Hive tables and Avro schemas as needed.</p>

        </div>

        <ol class="ol steps"><li class="li step stepexpand">
                <span class="ph cmd">In the Properties panel, on the <span class="keyword wintitle">General</span> tab, configure the
                    following properties:</span>
                <div class="itemgroup info">
                    
<div class="tablenoborder"><table cellpadding="4" cellspacing="0" summary="" id="task_a4n_1ft_zv__table_lck_rqj_kw" class="table" frame="border" border="1" rules="all">
                            
                            
                            <thead class="thead" align="left">
                                <tr class="row">
                                    <th class="entry" valign="top" width="30%" id="d36963e386">General Property</th>

                                    <th class="entry" valign="top" width="70%" id="d36963e389">Description</th>

                                </tr>

                            </thead>

                            <tbody class="tbody">
                                <tr class="row">
                                    <td class="entry" valign="top" width="30%" headers="d36963e386 ">Name</td>

                                    <td class="entry" valign="top" width="70%" headers="d36963e389 ">Stage name.</td>

                                </tr>

                                <tr class="row">
                                    <td class="entry" valign="top" width="30%" headers="d36963e386 ">Description</td>

                                    <td class="entry" valign="top" width="70%" headers="d36963e389 ">Optional description.</td>

                                </tr>

                                <tr class="row">
                                    <td class="entry" valign="top" width="30%" headers="d36963e386 ">Stage Library</td>

                                    <td class="entry" valign="top" width="70%" headers="d36963e389 ">Library version that you want to use. </td>

                                </tr>

                                <tr class="row">
                                    <td class="entry" valign="top" width="30%" headers="d36963e386 ">Required Fields</td>

                                    <td class="entry" valign="top" width="70%" headers="d36963e389 ">Since the destination processes only metadata records,
                                        this property is not relevant.</td>

                                </tr>

                                <tr class="row">
                                    <td class="entry" valign="top" width="30%" headers="d36963e386 ">Preconditions</td>

                                    <td class="entry" valign="top" width="70%" headers="d36963e389 ">Since the destination processes only metadata records,
                                        this property is not relevant.</td>

                                </tr>

                                <tr class="row">
                                    <td class="entry" valign="top" width="30%" headers="d36963e386 ">On Record Error <a class="xref" href="../Pipeline_Design/ErrorHandling.html#concept_atr_j4y_5r" title="Most stages include error record handling options. When an error occurs when processing a record, Data Collector processes records based on the On Record Error property for the stage.">
                                            <img class="image" id="task_a4n_1ft_zv__d1735e2934" src="../Reusable_Content/../Graphics/icon_moreInfo.png" height="12" width="12"></img></a></td>

                                    <td class="entry" valign="top" width="70%" headers="d36963e389 ">Error record handling for the stage: <ul class="ul" id="task_a4n_1ft_zv__d1735e2938">
                                            <li class="li">Discard - Discards the record.</li>

                                            <li class="li">Send to Error - Sends the record to the pipeline for
                                                error handling.</li>

                                            <li class="li">Stop Pipeline - Stops the pipeline.</li>

                                        </ul>
</td>

                                </tr>

                            </tbody>

                        </table>
</div>

                </div>
            </li>
<li class="li step stepexpand">
                <span class="ph cmd">On the <span class="keyword wintitle">Hive</span> tab, configure the following properties:</span>
                <div class="itemgroup info">
                    
<div class="tablenoborder"><table cellpadding="4" cellspacing="0" summary="" id="task_a4n_1ft_zv__table_yyp_54y_dw" class="table" frame="border" border="1" rules="all">
                            
                            
                            <thead class="thead" align="left">
                                <tr class="row">
                                    <th class="entry" valign="top" width="30%" id="d36963e499">Hive Property</th>

                                    <th class="entry" valign="top" width="70%" id="d36963e502">Description</th>

                                </tr>

                            </thead>

                            <tbody class="tbody">
                                <tr class="row">
       <td class="entry" valign="top" width="30%" headers="d36963e499 ">JDBC URL</td>

       <td class="entry" valign="top" width="70%" headers="d36963e502 ">JDBC URL for Hive. You can use the default, or replace the expression for the database
        name with a specific database name when appropriate.</td>

      </tr>

                                <tr class="row">
       <td class="entry" valign="top" width="30%" headers="d36963e499 ">JDBC Driver Name</td>

       <td class="entry" valign="top" width="70%" headers="d36963e502 ">The fully-qualified JDBC driver name.</td>

      </tr>

                                <tr class="row">
                                    <td class="entry" valign="top" width="30%" headers="d36963e499 ">Data Format</td>

                                    <td class="entry" valign="top" width="70%" headers="d36963e502 ">The destination processes only Avro schemas at this
                                        time.</td>

                                </tr>

                                <tr class="row">
       <td class="entry" valign="top" width="30%" headers="d36963e499 ">Hadoop Configuration Directory</td>

       <td class="entry" valign="top" width="70%" headers="d36963e502 ">
        <p class="p">Absolute path to the directory containing the Hive and Hadoop configuration files. For a
         Cloudera Manager installation, enter hive-conf. </p>

        <div class="p">The stage uses the following configuration files: <ul class="ul" id="task_a4n_1ft_zv__ul_tqf_lms_dw">
                  <li class="li">core-site.xml</li>

                  <li class="li">hdfs-site.xml</li>

                  <li class="li">hive-site.xml</li>

            </ul>
</div>

        <div class="note note"><span class="notetitle">Note:</span> Properties in the configuration files are overridden by individual properties defined
         in this processor. </div>

       </td>

      </tr>

                                <tr class="row">
       <td class="entry" valign="top" width="30%" headers="d36963e499 ">Additional Hadoop Configuration</td>

       <td class="entry" valign="top" width="70%" headers="d36963e502 ">
        <p class="p">Additional properties to use. </p>

        <p class="p">To add properties, click <span class="ph uicontrol">Add</span> and define the property name and
         value. Use the property names and values as expected by HDFS and Hive.</p>

       </td>

      </tr>

                            </tbody>

                        </table>
</div>

                </div>
            </li>
<li class="li step stepexpand">
                <span class="ph cmd">On the<span class="keyword wintitle"> Advanced</span> tab, optionally configure the following
                    properties:</span>
                <div class="itemgroup info">
                    
<div class="tablenoborder"><table cellpadding="4" cellspacing="0" summary="" id="task_a4n_1ft_zv__table_gbb_dpy_dw" class="table" frame="border" border="1" rules="all">
                            
                            
                            <thead class="thead" align="left">
                                <tr class="row">
                                    <th class="entry" valign="top" width="30%" id="d36963e610">Advanced Property</th>

                                    <th class="entry" valign="top" width="70%" id="d36963e613">Description</th>

                                </tr>

                            </thead>

                            <tbody class="tbody">
                                <tr class="row">
                                    <td class="entry" valign="top" width="30%" headers="d36963e610 ">Stored as Avro <a class="xref" href="HiveMetastore.html#concept_wyr_5jv_hw">
                                            <img class="image" id="task_a4n_1ft_zv__image_lqj_pyn_lw" src="../Graphics/icon_moreInfo.png" height="12" width="12"></img></a></td>

                                    <td class="entry" valign="top" width="70%" headers="d36963e613 ">Uses the Stored As Avro clause in the SQL commands that
                                        generate Hive tables. When selected, the Avro schema URL is
                                        not included in the query.</td>

                                </tr>

                                <tr class="row">
                                    <td class="entry" valign="top" width="30%" headers="d36963e610 ">Schema Folder Location</td>

                                    <td class="entry" valign="top" width="70%" headers="d36963e613 ">Location to store the Avro schemas when Stored as Avro is
                                        not selected. <p class="p">Use a leading slash ( / ) to specify a
                                            fully-qualified path. Omit the slash to specify a path
                                            relative to the table directory. </p>
<p class="p">When not
                                            specified, the schemas are stored in the .schema
                                            sub-folder of the table directory.</p>
</td>

                                </tr>

                                <tr class="row">
                                    <td class="entry" valign="top" width="30%" headers="d36963e610 ">HDFS User</td>

                                    <td class="entry" valign="top" width="70%" headers="d36963e613 ">Optional HDFS user for the destination to use when
                                        generating schemas.</td>

                                </tr>

                                <tr class="row">
                                    <td class="entry" valign="top" width="30%" headers="d36963e610 ">Max Cache Size (entries) <a class="xref" href="HiveMetastore.html#concept_f4y_spy_dw" title="The Hive Metastore destination queries Hive for information and caches the results. When possible, it uses the cache to avoid unnecessary Hive queries.">
                                            <img class="image" id="task_a4n_1ft_zv__image_mfn_hwx_5r" src="../Graphics/icon_moreInfo.png" height="12" width="12"></img></a></td>

                                    <td class="entry" valign="top" width="70%" headers="d36963e613 ">Maximum number of entries in the cache. <p class="p">When the cache
         reaches the maximum size, the oldest cached entries are evicted to allow for new
         data.</p>
<p class="p">Default is -1, an unlimited cache size.</p>
</td>

                                </tr>

                            </tbody>

                        </table>
</div>

                </div>
            </li>
</ol>

    </div>

</div>
</div>
<div class="navfooter"><!---->
<span class="navparent"><a class="link" href="../Destinations/Destinations-title.html" title="Destinations"><span class="navheader_label">Parent topic</span><span class="navheader_separator">: </span><span class="navheader_linktext">Destinations</span></a></span>  </div>
</body>
</html>